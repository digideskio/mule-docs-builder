<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="/docs/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/docs/css/bootstrap.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
    <link href="/docs/css/asciidoctor.css" rel="stylesheet">
    <link href="/docs/css/mule-docs.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    <script src="/docs/js/jquery-1.11.2.min.js"></script>
    <script src="/docs/js/bootstrap.js"></script>
    <title>MuleSoft Documentation - Assumptions</title>
</head>
<body>
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<div class="navbar navbar-inverse navbar-static-top">
    <div class="navbar-inner">
        <div class="container-fluid" id="top">
            <img src="/docs/img/mule-docs-logo.png">
        </div>
    </div>
</div>
<div class="container" id="main">
    <div class="row">
        <div class="col-md-3">
            <ul class="toc">

                <li class="toc-section"><div class="toc-section-header child"><a href="/docs/30-mins-with-mule/">First 30 Minutes with Mule</a><a href="#23J6E2Q9KL" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse in" id="23J6E2Q9KL"><a href="/docs/30-mins-with-mule/anypoint-platform-primer"><li class="child">Anypoint Platform Primer</li></a><a href="/docs/30-mins-with-mule/anypoint-studio-essentials"><li class="child">Anypoint Studio Essentials</li></a><a href="/docs/30-mins-with-mule/begin-with-the-basics"><li class="child">Begin with the Basics</li></a><a href="/docs/30-mins-with-mule/build+a+hello+world+application"><li class="child">Build a Hello World Application</li></a><a href="/docs/30-mins-with-mule/download-and-launch-anypoint-studio"><li class="child">Download and Launch Anypoint Studio</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub">CloudHub</a><a href="#J67YZP4YYO" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse in" id="J67YZP4YYO" style="height: 0px;"><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/getting-started-with-cloudhub">Getting Started with CloudHub</a><a href="#5RDD9349ID" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="5RDD9349ID" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-at-a-glance"><li class="child">CloudHub at a Glance</li></a><a href="/docs/cloudhub/v/3.6/hello-world-on-cloudhub"><li class="child">Hello World on CloudHub</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-getting-started-with-connectors"><li class="child">Getting Started with Connectors</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-tutorials">CloudHub Tutorials</a><a href="#G8SV6ZM77K" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="G8SV6ZM77K" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-building-an-https-service"><li class="child">Building an HTTPS Service</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-custom-application-alerts"><li class="child">Custom Application Alerts</li></a></ul></li><a href="/docs/cloudhub/v/3.6/developing-a-cloudhub-application"><li class="child">Developing a CloudHub Application</li></a><a href="/docs/cloudhub/v/3.6/deploying-a-cloudhub-application"><li class="child">Deploying a CloudHub Application</li></a><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/managing-cloudhub-applications">Managing CloudHub Applications</a><a href="#V87LY440FT" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse in" id="V87LY440FT"><a href="/docs/cloudhub/v/3.6/cloudhub-console-overview"><li class="child">CloudHub Console Overview</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-administration"><li class="child">CloudHub Administration</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-alerts-and-notifications"><li class="child">CloudHub Alerts and Notifications</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-fabric"><li class="child active">CloudHub Fabric</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-insight"><li class="child">CloudHub Insight</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-command-line-tools"><li class="child">Command Line Tools</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-managing-application-data-with-object-stores"><li class="child">Managing Application Data with Object Stores</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-managing-queues"><li class="child">Managing Queues</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-managing-schedules"><li class="child">Managing Schedules</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-secure-application-properties"><li class="child">Secure Application Properties</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-viewing-log-data"><li class="child">Viewing Log Data</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-virtual-private-cloud"><li class="child">Virtual Private Cloud</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-worker-monitoring"><li class="child">CloudHub Worker Monitoring</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-penetration-testing-policies"><li class="child">Penetration Testing Policies</li></a><a href="/docs/cloudhub/v/3.6/secure-data-gateway"><li class="child">Secure Data Gateway</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-api">CloudHub API</a><a href="#8M9VOXMWPI" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="8M9VOXMWPI" style="height: 0px;"><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-applications">Applications</a><a href="#LXUNEIK9PD" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="LXUNEIK9PD" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-create-application"><li class="child">Create Application</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-delete-application"><li class="child">Delete Application</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-deploy-application"><li class="child">Deploy Application</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-get-application"><li class="child">Get Application</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-list-all-applications"><li class="child">List All Applications</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-update-application-metadata"><li class="child">Update Application Metadata</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-logs">Logs</a><a href="#YB89VJR5M0" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="YB89VJR5M0" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-list-all-logs"><li class="child">List All Logs</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-notifications">Notifications</a><a href="#ZYHTMCTFVF" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="ZYHTMCTFVF" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-create-notification"><li class="child">Create Notification</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-list-notifications"><li class="child">List Notifications</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-update-all-notifications"><li class="child">Update All Notifications</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-update-notification"><li class="child">Update Notification</li></a></ul></li></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-architecture">CloudHub Architecture</a><a href="#NB6KNQTV9R" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="NB6KNQTV9R" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-networking-guide"><li class="child">CloudHub Networking Guide</li></a></ul></li><li class="toc-section"><div class="toc-section-header child"><a href="/docs/cloudhub/v/3.6/cloudhub-reference-materials">CloudHub Reference Materials</a><a href="#V4M42GBSOO" data-toggle="collapse" class="collapsed"><div class="toc-section-header-arrow"></div></a></div><ul class="collapsed child-section collapse" id="V4M42GBSOO" style="height: 0px;"><a href="/docs/cloudhub/v/3.6/cloudhub-amazon-rds-support"><li class="child">CloudHub Amazon RDS Support</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-configure-twitter-for-api-access"><li class="child">Configure Twitter for API Access</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-configure-twilio-for-api-access"><li class="child">Configure Twilio for API Access</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-salesforce-developer-account-setup"><li class="child">Salesforce Developer Account Setup</li></a></ul></li><a href="/docs/cloudhub/v/3.6/cloudhub-maintenance-and-upgrade-policy"><li class="child">Maintenance and Upgrade Policy</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-community-and-support"><li class="child">Community and Support</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-mule-esb-and-cloudhub"><li class="child">Mule ESB and CloudHub</li></a><a href="/docs/cloudhub/v/3.6/cloudhub-faq"><li class="child">FAQ</li></a></ul></li>

            </ul>

        </div>
        <!--/span-->
        <div class="col-md-9">
            <div id="content">

                <ol class="breadcrumb"><li><a href="developers.mulesoft.com/docs/">MuleSoft Docs</a></li><li><a href="cloudhub">CloudHub</a></li><li><a href="managing-cloudhub-applications">Managing CloudHub Applications</a></li><li class="active">CloudHub Fabric</li></ol>

                <div id="header">
                    <h1>Assumptions</h1>
                </div>
                <div id="doc-metadata">
                    <!--<span class="updated-date" style="color:#B1B1B1;">Updated: January 15, 2015</span>
                   <span class="updated-date" style="color:#DDD; padding: 0 0 0 7px;">/</span>-->
                    <span class="updated-date" style="color:#B1B1B1; padding: 0 0 0 0px;">Version: </span>
       <span class="dropdown" style="padding: 0 7px 0 0px;"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Current <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="#">January 2015</a></li>
            <li><a href="#">October 2014</a></li>
            <li><a href="#">July 2014</a></li>
        </ul> </span>
                    <span class="updated-date" style="color:#DDD; padding: 0 0 0 0px;">/</span>
       <span class="dropdown" style="padding: 0 7px 0 7px;"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Export <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="#">PDF - Only this page</a></li>
            <li><a href="#">PDF - CloudHub section</a></li>
            <li><a href="#">EPub - MuleSoft Docs</a></li>
        </ul> </span>
                    <span class="updated-date" style="color:#DDD; padding: 0 0 0 0px;">/</span>
       <span class="dropdown" style="padding: 0 7px 0 7px;"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Feedback <span class="caret"></span></a>
       <ul class="dropdown-menu" role="menu">
           <li><a href="#">Rate this Topic</a></li>
           <li><a href="#">Edit on GitHub</a></li>
       </ul> </span>
                </div>

                <div class="paragraph"> 
 <p>[[CloudHubFabric-CloudHubFabric&nbsp;Enterprise]] = CloudHub Fabric&nbsp;<br> <em>Enterprise</em></p> 
</div> 
<div class="paragraph"> 
 <p>CloudHub Fabric&nbsp;provides scalability, workload distribution, and added reliability to CloudHub applications. These capabilities are powered by CloudHub’s scalable load-balancing service,&nbsp;<strong><a href="#CloudHubFabric-WorkerScaleout">worker scaleout</a></strong>,&nbsp;and <strong><a href="#CloudHubFabric-PersistentQueues">persistent queueing</a></strong> features.</p> 
</div> 
<div class="paragraph"> 
 <p>You can <a href="#CloudHubFabric-EnablingCloudHubFabricFeatures">activate these features</a> on a per-application basis using the CloudHub console when you deploy a new application or redeploy an existing application.</p> 
</div> 
<div class="literalblock"> 
 <div class="content"> 
  <pre>&nbsp;Contents
link:#CloudHubFabric-Assumptions[Assumptions]
link:#CloudHubFabric-WorkerScaleout[Worker Scaleout]
link:#CloudHubFabric-PersistentQueues[Persistent Queues]
link:#CloudHubFabric-EnablingCloudHubFabricFeatures[Enabling CloudHub
Fabric Features]
link:#CloudHubFabric-UseCases[Use Cases]
link:#CloudHubFabric-BuildingMuleApplicationstoSupportPersistentQueues[Building
Mule Applications to Support Persistent Queues]
*
link:#CloudHubFabric-DifferencesbetweenOn-PremisesVMQueuesandCloudHubVMQueues[Differences
between On-Premises VM Queues and CloudHub VM Queues]</pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><a href="#CloudHubFabric-GoFurther">Go Further</a> &nbsp;</p> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-Assumptions"><a class="anchor" href="#CloudHubFabric-Assumptions"></a>Assumptions</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>CloudHub Fabric requires a CloudHub Enterprise or Partner account type.&nbsp;This document assumes that you have a&nbsp;http://www.mulesoft.com/cloudhub-plans-pricing[one of those account types]&nbsp;and that you are familiar with&nbsp;<a href="/documentation/display/current/Deploying+a+CloudHub+Application">deploying applications using the CloudHub console</a>.&nbsp;</p> 
  </div> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-WorkerScaleout"><a class="anchor" href="#CloudHubFabric-WorkerScaleout"></a>Worker Scaleout</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>CloudHub allows you to assign multiple workers to an application, providing horizontal scalability. This fine-grained control over worker provisioning gives you the flexibility to scale up your application to handle higher loads (or scale down during low-load periods) at any time.</p> 
  </div> 
  <table class="tableblock frame-all grid-all spread"> 
   <colgroup> 
    <col style="width: %;"> 
    <col style="width: %;"> 
   </colgroup> 
   <tbody> 
    <tr> 
     <td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/documentation/images/icons/emoticons/check.png" alt="image"></span></p></td> 
     <td class="tableblock halign-left valign-top"><p class="tableblock">For specs and details about each of the worker sizes see the <strong>Worker Sizing</strong> section of <a href="/documentation/display/current/Deploying+a+CloudHub+Application">Deploying a CloudHub Application</a></p></td> 
    </tr> 
   </tbody> 
  </table> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
  <div class="paragraph"> 
   <p>To allocate workers, select options from the drop down menus to configure the computing power that you need.&nbsp;</p> 
  </div> 
  <div class="paragraph"> 
   <p><span class="image"><img src="/documentation/download/attachments/118981817/image2014-10-25+0%3A0%3A22.png?version=1&amp;modificationDate=1414220423256" alt="image"></span> Each application can deploy up to four workers of any type. However, you may be limited to fewer than four workers based on how many workers are available in your subscription. See&nbsp;<a href="/documentation/display/current/Deploying+a+CloudHub+Application#DeployingaCloudHubApplication-WorkerSizing">Worker Sizing</a> for more information about deploying to multiple workers.</p> 
  </div> 
  <div class="paragraph"> 
   <p>Worker scaleout also adds additional reliability. MuleSoft will automatically distribute multiple workers for the same application across two or more datacenters for maximum reliability.</p> 
  </div> 
  <div class="paragraph"> 
   <p>When deploying your application to two or more workers, you can distribute workloads across these instances of Mule. CloudHub provides two facilities to do this:</p> 
  </div> 
  <div class="olist arabic"> 
   <ol class="arabic"> 
    <li> <p>The HTTP load balancing service will automatically distribute HTTP requests among your assigned workers.</p> </li> 
    <li> <p>Persistent message queues (see below)</p> </li> 
   </ol> 
  </div> 
  <table class="tableblock frame-all grid-all spread"> 
   <colgroup> 
    <col style="width: %;"> 
   </colgroup> 
   <tbody> 
    <tr> 
     <td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/documentation/images/icons/emoticons/warning.png" alt="image"></span></p></td> 
    </tr> 
    <tr> 
     <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/documentation/display/current/Batch+Processing">Batch jobs</a> only run on a single worker at a time, and will not be distributed across multiple workers.</p></td> 
    </tr> 
   </tbody> 
  </table> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>+
+</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-PersistentQueues"><a class="anchor" href="#CloudHubFabric-PersistentQueues"></a>Persistent Queues</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>Persistent queues ensure zero message loss and allows you to distribute workloads across a set of workers.<strong>&nbsp;</strong></p> 
  </div> 
  <div class="olist arabic"> 
   <ol class="arabic"> 
    <li> <p>* If your application is deployed to more than one worker, persistent queues allow interworker communication and workload distribution. For example, if a large file is placed in the queue, your workers can divide it up and process it in parallel.&nbsp;</p> 
     <div class="ulist"> 
      <ul> 
       <li> <p>Persistent queues will guarantee delivery of your messages, even if one or more workers or datacenters go down, providing additional message security for high-stakes processing.&nbsp;</p> </li> 
       <li> <p>With persistent queues enabled on your application, you have runtime visibility into your queues on the <a href="/documentation/display/current/Managing+Queues">Queues tab</a> in the CloudHub console.<br> <br></p> </li> 
      </ul> 
     </div> </li> 
   </ol> 
  </div> 
  <table class="tableblock frame-all grid-all spread"> 
   <colgroup> 
    <col style="width: %;"> 
    <col style="width: %;"> 
   </colgroup> 
   <tbody> 
    <tr> 
     <td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/documentation/images/icons/emoticons/warning.png" alt="image"></span></p></td> 
     <td class="tableblock halign-left valign-top"><p class="tableblock">Note that persistent queues do not guarantee one-time-only message delivery. Duplicate messages may be sent. If one-time-only message delivery is critical for your use case, do not enable persistent queues.</p></td> 
    </tr> 
   </tbody> 
  </table> 
  <div class="paragraph"> 
   <p>To learn more about how to work with persistent queues in your application, see <a href="/documentation/display/current/Managing+Queues">Managing Queues</a>.</p> 
  </div> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-EnablingCloudHubFabricFeatures"><a class="anchor" href="#CloudHubFabric-EnablingCloudHubFabricFeatures"></a>Enabling CloudHub Fabric Features</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>You can enable and disable either or both features of CloudHub Fabric in one of two ways:</p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>when deploying an application to CloudHub for the first time using the CloudHub console</p> </li> 
    <li> <p>by accessing the <strong>Deployment</strong> tab in the CloudHub console for a previously-deployed application</p> </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>Next to <strong>Workers</strong>, select options from the drop-down menus to&nbsp;define the number and type of workers assigned to your application. See <a href="/documentation/display/current/Deploying+a+CloudHub+Application#DeployingaCloudHubApplication-WorkerSizing">Worker Sizing</a> for more information about deploying to multiple workers.</p> 
  </div> 
  <div class="paragraph"> 
   <p>Expand the <strong>Advanced</strong> section, then check the <strong>Persistent Queues</strong>&nbsp;checkbox to enable queue persistence.&nbsp;</p> 
  </div> 
  <div class="paragraph"> 
   <p><span class="image"><img src="/documentation/download/attachments/118981817/image2014-10-25+0%3A3%3A10.png?version=1&amp;modificationDate=1414220590942" alt="image"></span></p> 
  </div> 
  <div class="paragraph"> 
   <p>If your application is already deployed, you need to redeploy it in order for your new settings to take effect.&nbsp;</p> 
  </div> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-UseCases"><a class="anchor" href="#CloudHubFabric-UseCases"></a>Use Cases</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>Depending on your use case, you may wish to take advantage of both CloudHub Fabric features on the same application, or you may prefer to enable just one of them, or neither.</p> 
  </div> 
  <div class="paragraph"> 
   <p>Considerations:</p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>In order to take advantage of persistent queueing, you must first set up your Mule application to support this feature. See <a href="#CloudHubFabric-BuildingMuleApplicationstoSupportPersistentQueues">Building Mule Applications to Support Persistent Queues</a>, below, for more information.</p> </li> 
    <li> <p>Enabling persistent queues has a performance implication: Putting a small message (50kb or less) on a queue can take 10-20 milliseconds (ms); taking the same message off a queue can take 70-100ms.&nbsp;</p> </li> 
    <li> <p>Adding additional workers increases the cost of service. &nbsp;<br> +</p> </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>Use Case Suggested CloudHub Fabric Configuration Implications You want to scale out your application, but you are satisfied with the existing highly available CloudHub architecture in terms of preventing service interruption or message loss. Persistent Queues Enabled? <strong>No</strong></p> 
  </div> 
  <div class="paragraph"> 
   <p>Number of Workers: <strong>2 or more</strong></p> 
  </div> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>Application performance is not affected by queueing latency.</p> </li> 
    <li> <p>No need to configure your application to support queue persistence.</p> </li> 
    <li> <p>If one datacenter experiences an outage, your workers are available in a different data center.</p> 
     <div class="literalblock"> 
      <div class="content"> 
       <pre>&nbsp;</pre> 
      </div> 
     </div> </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>You have a high-stakes process for which you need to protect against message loss, but you are not experiencing issues with handling processing load and are OK with some service interruption in the case of a data center outage. Persistent Queues Enabled? <strong>Yes</strong></p> 
  </div> 
  <div class="paragraph"> 
   <p>Number of Workers: <strong>1</strong></p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>Application may experience some queueing latency.</p> </li> 
    <li> <p>You need to configure your application to support queue persistence before deploying.</p> </li> 
    <li> <p>If the datacenter in which your worker operates experiences an outage, CloudHub will automatically migrate your application to another availability zone. You may experience some downtime during the migration; however, your persistent queue will ensure zero message loss.</p> </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>You have a high-stakes process for which you need to protect against message loss, avoid any chance of service interruption, and handle large processing loads. Persistent Queues Enabled? <strong>Yes</strong></p> 
  </div> 
  <div class="paragraph"> 
   <p>Number of Workers: <strong>2 or more</strong></p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>Application may experience some queueing latency.</p> </li> 
    <li> <p>You need to configure your application to support queue persistence before deploying.</p> </li> 
    <li> <p>If one datacenter experiences an outage, your workers are automatically distributed to ensure redundancy.</p> </li> 
   </ul> 
  </div> 
  <div class="paragraph"> 
   <p>You have an application that does not have any special requirements regarding either processing load or message loss. Persistent Queues Enabled? <strong>No</strong></p> 
  </div> 
  <div class="paragraph"> 
   <p>Number of Workers: <strong>1</strong></p> 
  </div> 
  <div class="ulist"> 
   <ul> 
    <li> <p>Application performance is not affected by queueing latency.</p> </li> 
    <li> <p>No need to configure your application to support queue persistence.</p> </li> 
    <li> <p>If the datacenter in which your worker operates experiences an outage, CloudHub will automatically migrate your application to another availability zone, but you may experience some downtime and message loss during the migration.</p> </li> 
   </ul> 
  </div> 
  <table class="tableblock frame-all grid-all spread"> 
   <colgroup> 
    <col style="width: %;"> 
    <col style="width: %;"> 
   </colgroup> 
   <tbody> 
    <tr> 
     <td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/documentation/images/icons/emoticons/information.png" alt="image"></span></p></td> 
     <td class="tableblock halign-left valign-top"> 
      <div> 
       <div class="paragraph"> 
        <p><strong>Persistent Queuing Behavior for Applications Containing Batch Jobs</strong><br> When you deploy an application containing <a href="/documentation/display/current/Batch+Processing">batch jobs</a> to CloudHub with persistent queues enabled, the batch jobs will use CloudHub’s persistent queuing feature for the batch queuing functionality to ensure zero message loss. However, there are two limitations:</p> 
       </div> 
       <div class="ulist"> 
        <ul> 
         <li> <p>Batch jobs using CloudHub persistent queues experience additional latency</p> </li> 
         <li> <p>CloudHub persistent queues will occasionally process a message more than once. If your use case requires that each message be guaranteed to be processed only once, consider deploying the application without enabling persistent queues.</p> </li> 
        </ul> 
       </div> 
      </div></td> 
    </tr> 
   </tbody> 
  </table> 
  <div class="literalblock"> 
   <div class="content"> 
    <pre>&nbsp;</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-BuildingMuleApplicationstoSupportPersistentQueues"><a class="anchor" href="#CloudHubFabric-BuildingMuleApplicationstoSupportPersistentQueues"></a>Building Mule Applications to Support Persistent Queues</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>In order for your application to reap the benefits of persistent queuing, you will need to implement <a href="/documentation/display/current/Reliability+Patterns">reliability patterns</a> in your application code, separating individual <a href="/documentation/display/current/XA+Transactions">XA transactions</a> with <a href="/documentation/display/current/VM+Transport+Reference">VM transports</a>, as shown below.&nbsp;</p> 
  </div> 
  <div class="paragraph"> 
   <p><span class="image"><img src="/documentation/download/attachments/118981817/CH_Fabric.png?version=1&amp;modificationDate=1414198598674" alt="image"></span></p> 
  </div> 
  <div class="paragraph"> 
   <p>The&nbsp;<strong>reliable acquisition flow</strong>&nbsp;delivers a message reliably from the inbound endpoint of your application to an outbound VM endpoint. If the reliable acquisition flow cannot put the message into the VM queue, it ensures that the message is not lost by&nbsp;returning an "unsuccessful request" response to the client so that the client can retry the request.</p> 
  </div> 
  <div class="paragraph"> 
   <p>The&nbsp;<strong>application logic flow</strong>&nbsp;delivers the message from an inbound VM endpoint to the business logic processing in your application. This flow represents one transaction. (Your business logic may involve several other transactions, not shown.)&nbsp;</p> 
  </div> 
  <div class="paragraph"> 
   <p>In between these two flows, a <strong>persistent VM queue</strong> holds the messages committed by the reliable acquisition flow until they are ready for processing by the application logic flow.&nbsp;In case of a processing error within the transaction or in case of a transaction timeout (the time allotted for the transaction is exceeded), Mule triggers a rollback. This rollback erases any partial processing that has occurred on the message and places the message back on the queue. If your Mule instance experiences an outage and is unable to explicitly roll back a transaction, the transaction will automatically roll back once the time allotted for the transaction is exceeded. The allotted time is determined by the <code>timeout</code> attribute of the transaction element. You can configure the timeout yourself, or accept the default.</p> 
  </div> 
  <div class="paragraph"> 
   <p>It is helpful to think of each transaction in terms of three steps:</p> 
  </div> 
  <div class="olist arabic"> 
   <ol class="arabic"> 
    <li> <p><strong>Begin</strong>. Mule kicks off the processing of all subcomponents within the transaction.&nbsp;</p> </li> 
    <li> <p><strong>Commit</strong>. Mule sends the result of the completed transaction on to the next step. (For XA transactions, the commit step has two phases: a <em>commit-request phase</em> and a <em>commit phase</em>. During the commit-request phase, Mule coordinates the results of the multiple resources within the scope of the transaction and confirms that all processing executed successfully and is ready to commit. The commit phase then calls each resource to commit its processing.)</p> </li> 
    <li> <p><strong>Rollback</strong>. If an error occurs in either the Begin or Commit steps, Mule rolls back the operations within the transaction so that no one part results in partial completion.</p> </li> 
   </ol> 
  </div> 
  <div class="paragraph"> 
   <p>The following code snippet provides an example of an application set up in a reliability pattern using VM transports for queue persistence on CloudHub.</p> 
  </div> 
  <div class="sect2"> 
   <h3 id="CloudHubFabric-DifferencesbetweenOn-PremisesVMQueuesandCloudHubVMQueues"><a class="anchor" href="#CloudHubFabric-DifferencesbetweenOn-PremisesVMQueuesandCloudHubVMQueues"></a>Differences between On-Premises VM Queues and CloudHub VM Queues</h3> 
   <div class="paragraph"> 
    <p>Although you can refer to the complete references for <a href="/documentation/display/current/Transaction+Management">Transaction Management</a>, the <a href="/documentation/display/current/VM+Transport+Reference">VM transport</a>, and <a href="/documentation/display/current/Reliability+Patterns">Reliability Patterns</a>, note that CloudHub imposes some key differences in the way that persistent queues are implemented.&nbsp;</p> 
   </div> 
   <div class="paragraph"> 
    <p>VM Queues in On-Premises Applications VM Queues in CloudHub Applications You can configure the maximum number of outstanding messages using the queue-profile element. There is no limit to the number of outstanding messages in CloudHub. Even if you have a queue-profile element coded in your application with a maximum number of outstanding messages, CloudHub allows unlimited outstanding messages if you deploy the application to CloudHub with the Persistent Queues checkbox checked. You can toggle the persistence of the queue using the queue-profile element. The persistence of your queue is managed using the Persistent Queues checkbox in the Advanced Details section of the deployment dialog. Even if you have a queue-profile element coded in your application, CloudHub overrides these settings when you deploy the application to CloudHub with the Persistent Queues checkbox checked. You can define a queue store for your VM queue to use. CloudHub manages the queue store for you, so there is no need to define a queue store. Transaction commits and rollbacks for XA transactions operate according to the <a href="http://en.wikipedia.org/wiki/Two-phase_commit_protocol">two-phase commit algorithm</a>. In CloudHub, there is an important exception to the way the two-phase commit algorithm works for XA transactions when a message is being added to a queue. See the <a href="#CloudHubFabric-knownissue">known issue</a> described below for details. (Note that when CloudHub <em>consumes</em> messages from a persistent queue, this exception to the two-phase commit algorithm does not apply.)</p> 
   </div> 
   <table class="tableblock frame-all grid-all spread"> 
    <colgroup> 
     <col style="width: %;"> 
     <col style="width: %;"> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/documentation/images/icons/emoticons/warning.png" alt="image"></span></p></td> 
      <td class="tableblock halign-left valign-top"> 
       <div> 
        <div class="paragraph"> 
         <p><strong>Known Issue</strong><br> When messages are added to a VM queue in CloudHub, the two-phase commit protocol for XA transactions can fail to roll back a complete transaction if the following conditions are true:</p> 
        </div> 
        <div class="ulist"> 
         <ul> 
          <li> <p>The commit-request phase has completed successfully. (All participating processes within the transaction execute successfully, so the message is ready to commit to the queue.)</p> </li> 
          <li> <p>During the commit phase, an error occurs that causes a subprocess within the transaction to fail to commit, triggering a rollback of the transaction.</p> </li> 
          <li> <p>The VM outbound endpoint completes its commit before the rollback occurs.</p> </li> 
         </ul> 
        </div> 
        <div class="paragraph"> 
         <p>If all three above conditions are true, the message will be added to the queue instead of being rolled back as intended by the transaction rollback process. No message loss occurs, and the transaction can still be repeated, but the outbound VM queue will contain an unintended message.</p> 
        </div> 
        <div class="paragraph"> 
         <p>Note that this issue occurs only when a flow <em>produces</em> messages that need to be added to a VM queue. There is no effect on the process of consuming messages from queues.</p> 
        </div> 
       </div></td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="literalblock"> 
    <div class="content"> 
     <pre>&nbsp;</pre> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="sect1"> 
 <h2 id="CloudHubFabric-GoFurther"><a class="anchor" href="#CloudHubFabric-GoFurther"></a>Go Further</h2> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>* See&nbsp;<a href="/documentation/display/current/Deploying+a+CloudHub+Application#DeployingaCloudHubApplication-WorkerSizing">Worker Sizing</a>&nbsp;for more information about deploying to multiple workers. * See&nbsp;<a href="/documentation/display/current/Managing+Queues">Managing Queues</a>&nbsp;for more information about viewing your queues at runtime. * Learn more about the <a href="/documentation/display/current/CloudHub+Architecture">CloudHub architecture</a>. * Investigate the other <a href="/documentation/display/current/Deploying+a+CloudHub+Application#DeployingaCloudHubApplication-AdvancedApplicationOptions">advanced options for deploying your CloudHub applications</a>. * Refer to the complete references for&nbsp;<a href="/documentation/display/current/Transaction+Management">Transaction Management</a>, the&nbsp;<a href="/documentation/display/current/VM+Transport+Reference">VM transport</a>, and&nbsp;<a href="/documentation/display/current/Reliability+Patterns">Reliability Patterns</a>.</p> 
  </div> 
 </div> 
</div>

            </div>
        </div>
    </div>
</div>
</body>
</html>
